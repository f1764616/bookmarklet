<a href="javascript:function gTd(){if(0==searchT()||null==searchT().offsetParent)return alert('выберите таблицу'),void 0;for(t='table'==searchT().offsetParent.localName?searchT().offsetParent.tBodies:searchT().offsetParent.offsetParent.tBodies,i=0;t.length>i;i++)for(r=0;t[i].rows.length>r;r++){for(c=0;t[i].rows[r].cells.length>c;c++)t[i].rows[r].cells[c].getElementsByTagName('table').length>=1?(walkTre(t[i].rows[r].cells[c]),m+=ppp):t[i].rows[r].cells[c].childNodes.length>1?(m=walkChild(t[i].rows[r].cells[c]),m1=''):t[i].rows[r].cells[c].getElementsByTagName('a').length>=1?m+=t[i].rows[r].cells[c].getElementsByTagName('a')[0].text+'@'+t[i].rows[r].cells[c].getElementsByTagName('a')[0].getAttribute('href').replace('http://','')+' ':t[i].rows[r].cells[c].getElementsByTagName('img').length>=1?m+=t[i].rows[r].cells[c].getElementsByTagName('img')[0].alt+'@src='+t[i].rows[r].cells[c].getElementsByTagName('img')[0].getAttribute('src')+ppp:m=t[i].rows[r].cells[c].textContent+ppp,o+=m,m='';o+='<br>'}w=window.open('','','toolbar=0,location=0,scrollbars=1'),w.document.write(o),o=''}function searchT(){return q=''+(window.getSelection?window.getSelection():document.getSelection?document.getSelection():document.selection.createRange().text),selected=q?null!=q?document.getSelection().anchorNode.parentElement:0:0}function walkChild(a){var b=0;if('#text'==a.nodeName&&(m1+=a.textContent),'A'==a.nodeName&&(m1+=a.text+'@'+a.getAttribute('href').replace('http://','')+' ',b++),'IMG'==a.nodeName&&(m1+=a.alt+'@src='+a.getAttribute('src')+' ',b++),0==b)for(var c=0;a.childNodes.length>c;c++)walkChild(a.childNodes[c]);return m1}function walkTre(a){null!=a.nodeValue&&(m+=a.nodeValue);for(var b=0;a.childNodes.length>b;b++)walkTre(a.childNodes[b])}var ppp='&nbsp&nbsp&nbsp&nbsp&nbsp',m='',m='',m1='',t='',o='';gTd()">Выбрать текст из таблицы</a>
